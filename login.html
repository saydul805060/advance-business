<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>লগইন - Advance Business App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #121921;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8vmin;
            flex-wrap: wrap;
            padding: 2rem;
            width: 100%;
            max-width: 1200px;
        }

        /* Lamp Styles */
        .lamp-container {
            flex: 1;
            min-width: 300px;
            max-width: 500px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .lamp {
            width: 100%;
            height: auto;
            max-height: 500px;
        }

        /* Login Form Styles */
        .login-form-container {
            flex: 1;
            min-width: 320px;
            max-width: 450px;
        }

        .login-form {
            background: rgba(18, 25, 33, 0.95);
            padding: 40px 35px;
            border-radius: 20px;
            width: 100%;
            opacity: 0;
            transform: scale(0.8) translateY(20px);
            pointer-events: none;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            border: 2px solid transparent;
            box-shadow: 0 0 0px rgba(255, 255, 255, 0);
        }

        .login-form.active {
            opacity: 1;
            transform: scale(1) translateY(0);
            pointer-events: all;
            border-color: #e06952;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.1),
                        0 0 30px rgba(224, 105, 82, 0.5),
                        inset 0 0 15px rgba(255, 255, 255, 0.05);
        }

        .login-form h2 {
            color: #fff;
            font-size: 32px;
            margin: 0 0 30px 0;
            text-align: center;
            text-shadow: 0 0 8px rgba(224, 105, 82, 0.8);
            font-weight: 700;
        }

        .form-group {
            margin-bottom: 25px;
            position: relative;
        }

        .form-group label {
            display: block;
            color: #aaa;
            font-size: 14px;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-with-icon {
            position: relative;
        }

        .input-with-icon i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #e06952;
            font-size: 18px;
        }

        .input-with-icon input {
            width: 100%;
            padding: 16px 16px 16px 50px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: #fff;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .input-with-icon input:focus {
            outline: none;
            border-color: #e06952;
            box-shadow: 0 0 10px rgba(224, 105, 82, 0.5);
            background: rgba(255, 255, 255, 0.08);
        }

        .input-with-icon input::placeholder {
            color: #666;
            font-size: 14px;
        }

        .remember-forgot {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .remember-me {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .remember-me input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #e06952;
        }

        .remember-me label {
            color: #aaa;
            font-size: 14px;
            cursor: pointer;
            margin: 0;
        }

        .forgot-link {
            color: #e06952;
            font-size: 14px;
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .forgot-link:hover {
            text-shadow: 0 0 10px rgba(224, 105, 82, 0.8);
            text-decoration: underline;
        }

        .login-btn {
            width: 100%;
            padding: 17px;
            background: linear-gradient(135deg, #e06952, #c55a44);
            border: none;
            border-radius: 12px;
            color: #fff;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            margin-bottom: 25px;
            letter-spacing: 0.5px;
        }

        .login-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3),
                        0 0 20px rgba(224, 105, 82, 0.4);
        }

        .login-btn:active {
            transform: translateY(0);
        }

        .login-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .signup-link {
            text-align: center;
            margin-top: 20px;
            color: #aaa;
            font-size: 14px;
        }

        .signup-link a {
            color: #e06952;
            text-decoration: none;
            font-weight: 500;
            margin-left: 5px;
            transition: all 0.3s ease;
        }

        .signup-link a:hover {
            text-shadow: 0 0 10px rgba(224, 105, 82, 0.8);
            text-decoration: underline;
        }

        .error-message {
            color: #ff4444;
            font-size: 14px;
            margin-top: 5px;
            min-height: 20px;
            text-align: center;
        }

        .success-message {
            color: #4CAF50;
            font-size: 14px;
            margin-top: 5px;
            min-height: 20px;
            text-align: center;
        }

        /* Language Selector */
        .language-selector {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 10;
        }

        .language-selector select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 8px 15px;
            color: white;
            font-size: 14px;
            cursor: pointer;
            outline: none;
        }

        .language-selector select option {
            background: #121921;
            color: white;
        }

        /* Lamp Animation Styles */
        .cord {
            stroke: hsl(210, 0%, 40%);
        }

        .cord--rig {
            display: none;
        }

        .lamp__tongue {
            fill: #e06952;
        }

        .lamp__hit {
            cursor: pointer;
            opacity: 0;
        }

        .lamp__feature {
            fill: #0a0a0a;
        }

        .lamp__stroke {
            stroke: #0a0a0a;
        }

        .lamp__mouth,
        .lamp__light {
            opacity: 0;
        }

        .shade__opening {
            fill: hsl(50, 10%, 20%);
        }

        .shade__opening-shade {
            opacity: 1;
        }

        .post__body {
            fill: hsl(210, 0%, 20%);
        }

        .base__top {
            fill: hsl(210, 0%, 40%);
        }

        .base__side {
            fill: hsl(210, 0%, 20%);
        }

        .top__body {
            fill: hsl(320, 0%, 10%);
        }

        /* When lamp is on */
        .lamp-on .cord {
            stroke: hsl(210, 0%, 90%);
        }

        .lamp-on .lamp__mouth,
        .lamp-on .lamp__light {
            opacity: 1;
        }

        .lamp-on .shade__opening {
            fill: hsl(50, 90%, 90%);
        }

        .lamp-on .shade__opening-shade {
            opacity: 0;
        }

        .lamp-on .post__body {
            fill: hsl(210, 0%, 60%);
        }

        .lamp-on .base__top {
            fill: hsl(210, 0%, 80%);
        }

        .lamp-on .base__side {
            fill: hsl(210, 0%, 60%);
        }

        .lamp-on .top__body {
            fill: hsl(320, 20%, 70%);
        }
        
        /* Lamp off initially */
        .lamp-off {
            opacity: 0.7;
        }
        
        .lamp-off .cord {
            stroke: hsl(210, 0%, 40%);
        }
        
        .lamp-off .lamp__mouth,
        .lamp-off .lamp__light {
            opacity: 0;
        }
        
        .lamp-off .shade__opening {
            fill: hsl(50, 10%, 20%);
        }
        
        .lamp-off .post__body {
            fill: hsl(210, 0%, 20%);
        }
        
        .lamp-off .base__top {
            fill: hsl(210, 0%, 40%);
        }
        
        .lamp-off .top__body {
            fill: hsl(320, 0%, 10%);
        }

        @media (max-width: 900px) {
            .container {
                flex-direction: column;
                gap: 4vmin;
            }
            
            .lamp-container {
                max-width: 300px;
            }
            
            .login-form {
                padding: 30px 25px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 1rem;
            }
            
            .login-form {
                padding: 25px 20px;
            }
            
            .login-form h2 {
                font-size: 28px;
            }
            
            .remember-forgot {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }
        
        /* Instructions */
        .instructions {
            text-align: center;
            color: #aaa;
            font-size: 14px;
            margin-top: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border-left: 3px solid #e06952;
        }
    </style>
</head>
<body>
    <!-- Language Selector -->
    <div class="language-selector">
        <select id="languageSelect">
            <option value="bn">বাংলা</option>
            <option value="en">English</option>
        </select>
    </div>

    <div class="container">
        <!-- Lamp SVG -->
        <div class="lamp-container">
            <svg class="lamp lamp-off" viewBox="0 0 333 484" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g class="lamp__shade shade">
                    <ellipse class="shade__opening" cx="165" cy="220" rx="130" ry="20"/>
                    <ellipse class="shade__opening-shade" cx="165" cy="220" rx="130" ry="20" fill="url(#opening-shade)"/>
                </g>
                <g class="lamp__base base">
                    <path class="base__side" d="M165 464c44.183 0 80-8.954 80-20v-14h-22.869c-14.519-3.703-34.752-6-57.131-6-22.379 0-42.612 2.297-57.131 6H85v14c0 11.046 35.817 20 80 20z"/>
                    <path d="M165 464c44.183 0 80-8.954 80-20v-14h-22.869c-14.519-3.703-34.752-6-57.131-6-22.379 0-42.612 2.297-57.131 6H85v14c0 11.046 35.817 20 80 20z" fill="url(#side-shading)"/>
                    <ellipse class="base__top" cx="165" cy="430" rx="80" ry="20"/>
                    <ellipse cx="165" cy="430" rx="80" ry="20" fill="url(#base-shading)"/>
                </g>
                <g class="lamp__post post">
                    <path class="post__body" d="M180 142h-30v286c0 3.866 6.716 7 15 7 8.284 0 15-3.134 15-7V142z"/>
                    <path d="M180 142h-30v286c0 3.866 6.716 7 15 7 8.284 0 15-3.134 15-7V142z" fill="url(#post-shading)"/>
                </g>
                <g class="lamp__cords cords">
                    <path class="cord cord--rig" d="M124 187.033V347" stroke-width="6" stroke-linecap="round"/>
                    <path class="cord cord--rig" d="M124 187.023s17.007 21.921 17.007 34.846c0 12.925-11.338 23.231-17.007 34.846-5.669 11.615-17.007 21.921-17.007 34.846 0 12.925 17.007 34.846 17.007 34.846" stroke-width="6" stroke-linecap="round"/>
                    <path class="cord cord--rig" d="M124 187.017s-21.259 17.932-21.259 30.26c0 12.327 14.173 20.173 21.259 30.26 7.086 10.086 21.259 17.933 21.259 30.26 0 12.327-21.259 30.26-21.259 30.26" stroke-width="6" stroke-linecap="round"/>
                    <path class="cord cord--rig" d="M124 187s29.763 8.644 29.763 20.735-19.842 13.823-29.763 20.734c-9.921 6.912-29.763 8.644-29.763 20.735S124 269.939 124 269.939" stroke-width="6" stroke-linecap="round"/>
                    <path class="cord cord--rig" d="M124 187.029s-10.63 26.199-10.63 39.992c0 13.794 7.087 26.661 10.63 39.992 3.543 13.331 10.63 26.198 10.63 39.992 0 13.793-10.63 39.992-10.63 39.992" stroke-width="6" stroke-linecap="round"/>
                    <path class="cord cord--rig" d="M124 187.033V347" stroke-width="6" stroke-linecap="round"/>
                    <line class="cord cord--dummy" x1="124" y2="348" x2="124" y1="190" stroke-width="6" stroke-linecap="round"/>
                </g>
                <path class="lamp__light" d="M290.5 193H39L0 463.5c0 11.046 75.478 20 165.5 20s167-11.954 167-23l-42-267.5z" fill="url(#light)"/>
                <g class="lamp__top top">
                    <path class="top__body" fill-rule="evenodd" clip-rule="evenodd" d="M164.859 0c55.229 0 100 8.954 100 20l29.859 199.06C291.529 208.451 234.609 200 164.859 200S38.189 208.451 35 219.06L64.859 20c0-11.046 44.772-20 100-20z"/>
                    <path class="top__shading" fill-rule="evenodd" clip-rule="evenodd" d="M164.859 0c55.229 0 100 8.954 100 20l29.859 199.06C291.529 208.451 234.609 200 164.859 200S38.189 208.451 35 219.06L64.859 20c0-11.046 44.772-20 100-20z" fill="url(#top-shading)"/>
                </g>
                <g class="lamp__face face">
                    <g class="lamp__mouth">
                        <path d="M165 178c19.882 0 36-16.118 36-36h-72c0 19.882 16.118 36 36 36z" fill="#141414"/>
                        <clipPath class="lamp__feature" id="mouth" x="129" y="142" width="72" height="36">
                            <path d="M165 178c19.882 0 36-16.118 36-36h-72c0 19.882 16.118 36 36 36z" fill="#141414"/>
                        </clipPath>
                        <g clip-path="url(#mouth)">
                            <circle class="lamp__tongue" cx="179.4" cy="172.6" r="18"/>
                        </g>
                    </g>
                    <g class="lamp__eyes">
                        <path class="lamp__eye lamp__stroke" d="M115 135c0-5.523-5.82-10-13-10s-13 4.477-13 10" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
                        <path class="lamp__eye lamp__stroke" d="M241 135c0-5.523-5.82-10-13-10s-13 4.477-13 10" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
                    </g>
                </g>
                <defs>
                    <linearGradient id="opening-shade" x1="35" y1="220" x2="295" y2="220" gradientUnits="userSpaceOnUse">
                        <stop/>
                        <stop offset="1" stop-color="var(--shade)" stop-opacity="0"/>
                    </linearGradient>
                    <linearGradient id="base-shading" x1="85" y1="444" x2="245" y2="444" gradientUnits="userSpaceOnUse">
                        <stop stop-color="hsla(45, 0%, 50%, 0.85)"/>
                        <stop offset="0.8" stop-color="hsla(45, 0%, 20%, 0.25)" stop-opacity="0"/>
                    </linearGradient>
                    <linearGradient id="side-shading" x1="119" y1="430" x2="245" y2="430" gradientUnits="userSpaceOnUse">
                        <stop stop-color="hsla(45, 0%, 20%, 0.5)"/>
                        <stop offset="1" stop-color="hsla(45, 0%, 20%, 0.25)" stop-opacity="0"/>
                    </linearGradient>
                    <linearGradient id="post-shading" x1="150" y1="288" x2="180" y2="288" gradientUnits="userSpaceOnUse">
                        <stop stop-color="hsla(45, 0%, 50%, 0.85)"/>
                        <stop offset="1" stop-color="hsla(45, 0%, 20%, 0.25)" stop-opacity="0"/>
                    </linearGradient>
                    <linearGradient id="light" x1="165.5" y1="218.5" x2="165.5" y2="483.5" gradientUnits="userSpaceOnUse">
                        <stop stop-color="hsla(45, 0%, 50%, 0.2)" stop-opacity=".2"/>
                        <stop offset="1" stop-color="hsla(45, 0%, 50%, 0.85)" stop-opacity="0"/>
                    </linearGradient>
                    <linearGradient id="top-shading" x1="56" y1="110" x2="295" y2="110" gradientUnits="userSpaceOnUse">
                        <stop stop-color="hsl(320, 0%, 30%)" stop-opacity=".8"/>
                        <stop offset="1" stop-color="hsl(320, 0%, 20%)" stop-opacity="0"/>
                    </linearGradient>
                </defs>
                <circle class="lamp__hit" cx="124" cy="347" r="66" fill="#C4C4C4" fill-opacity=".1"/>
            </svg>
        </div>

        <!-- Login Form -->
        <div class="login-form-container">
            <div class="login-form" id="loginForm">
                <h2>লগইন করুন</h2>
                <form id="loginFormElement">
                    <div class="form-group">
                        <label for="username">ইউজারনেম</label>
                        <div class="input-with-icon">
                            <i class="fas fa-user"></i>
                            <input type="text" id="username" placeholder="আপনার ইউজারনেম দিন" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">পাসওয়ার্ড</label>
                        <div class="input-with-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="password" placeholder="আপনার পাসওয়ার্ড দিন" required>
                        </div>
                    </div>
                    
                    <div class="remember-forgot">
                        <div class="remember-me">
                            <input type="checkbox" id="rememberMe">
                            <label for="rememberMe">আমাকে মনে রাখুন</label>
                        </div>
                        <a href="forgot-password.html" class="forgot-link">পাসওয়ার্ড ভুলে গেছেন?</a>
                    </div>
                    
                    <div class="instructions">
                        <i class="fas fa-info-circle"></i> ল্যাম্পের সুতা টেনে জ্বালানোর পর লগইন বাটন কাজ করবে
                    </div>
                    
                    <div class="error-message" id="errorMessage"></div>
                    <div class="success-message" id="successMessage"></div>
                    
                    <button type="submit" class="login-btn" id="loginBtn" disabled>ল্যাম্প জ্বালান</button>
                    
                    <div class="signup-link">
                        নতুন ব্যবহারকারী? <a href="signup.html" id="signupLink">একাউন্ট তৈরি করুন</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://unpkg.co/gsap@3/dist/gsap.min.js"></script>
    <script src="https://unpkg.com/gsap@3/dist/Draggable.min.js"></script>
    <script src="https://assets.codepen.io/16327/MorphSVGPlugin3.min.js"></script>

    <script>
        // GSAP এবং প্লাগইন রেজিস্টার করুন
        const { gsap } = window;
        const { MorphSVGPlugin } = window;
        const { Draggable } = window;
        gsap.registerPlugin(MorphSVGPlugin);

        // অডিও সেটআপ
        const AUDIO = {
            CLICK: new Audio("https://assets.codepen.io/605876/click.mp3")
        };

        // DOM এলিমেন্টস
        const LAMP_SVG = document.querySelector('.lamp');
        const LOGIN_FORM = document.getElementById('loginForm');
        const LOGIN_FORM_ELEMENT = document.getElementById('loginFormElement');
        const LOGIN_BTN = document.getElementById('loginBtn');
        const ERROR_MESSAGE = document.getElementById('errorMessage');
        const SUCCESS_MESSAGE = document.getElementById('successMessage');
        const SIGNUP_LINK = document.getElementById('signupLink');
        const REMEMBER_ME = document.getElementById('rememberMe');

        // ল্যাম্প অ্যানিমেশন ভেরিয়েবলস
        const CORDS = gsap.utils.toArray(".cords path");
        const CORD_DURATION = 0.1;
        const HIT = document.querySelector(".lamp__hit");
        const DUMMY_CORD = document.querySelector(".cord--dummy");
        const ENDX = DUMMY_CORD.getAttribute("x2");
        const ENDY = DUMMY_CORD.getAttribute("y2");
        const PROXY = document.createElement("div");

        let startX, startY;
        let STATE = { ON: false };
        let IS_LAMP_ON = false;

        // প্রোক্সি সেটআপ
        const RESET = () => {
            gsap.set(PROXY, { x: ENDX, y: ENDY });
        };
        RESET();

        // ইনিশিয়াল সেটআপ - ল্যাম্প বন্ধ অবস্থায়
        gsap.set([".cords", HIT], { x: -10 });
        gsap.set(".lamp__eye", { rotate: 180, transformOrigin: "50% 50%", yPercent: 50 });
        
        // ল্যাম্প বন্ধ অবস্থায় শুরু করুন
        LAMP_SVG.classList.remove('lamp-on');
        LAMP_SVG.classList.add('lamp-off');
        LOGIN_FORM.classList.remove('active');
        LOGIN_BTN.disabled = true;
        LOGIN_BTN.textContent = 'ল্যাম্প জ্বালান';

        // কর্ড অ্যানিমেশন টাইমলাইন
        const CORD_TL = gsap.timeline({
            paused: true,
            onStart: () => {
                STATE.ON = !STATE.ON;
                
                // ল্যাম্প স্টেট পরিবর্তন
                if (STATE.ON) {
                    LAMP_SVG.classList.remove('lamp-off');
                    LAMP_SVG.classList.add('lamp-on');
                    LOGIN_FORM.classList.add('active');
                    IS_LAMP_ON = true;
                    LOGIN_BTN.disabled = false;
                    LOGIN_BTN.textContent = 'লগইন করুন';
                } else {
                    LAMP_SVG.classList.remove('lamp-on');
                    LAMP_SVG.classList.add('lamp-off');
                    LOGIN_FORM.classList.remove('active');
                    IS_LAMP_ON = false;
                    LOGIN_BTN.disabled = true;
                    LOGIN_BTN.textContent = 'ল্যাম্প জ্বালান';
                }
                
                // চোখের অ্যানিমেশন
                gsap.set(".lamp__eye", { rotate: STATE.ON ? 0 : 180 });
                
                // কর্ড ডিসপ্লে সেটিং
                gsap.set([DUMMY_CORD, HIT], { display: "none" });
                gsap.set(CORDS[0], { display: "block" });
                
                // অডিও প্লে
                AUDIO.CLICK.play();
            },
            onComplete: () => {
                gsap.set([DUMMY_CORD, HIT], { display: "block" });
                gsap.set(CORDS[0], { display: "none" });
                RESET();
            }
        });

        // কর্ড মর্ফিং অ্যানিমেশন
        for (let i = 1; i < CORDS.length; i++) {
            CORD_TL.add(
                gsap.to(CORDS[0], {
                    morphSVG: CORDS[i],
                    duration: CORD_DURATION,
                    repeat: 1,
                    yoyo: true
                })
            );
        }

        // ল্যাম্প কর্ড ড্র্যাগেবল
        Draggable.create(PROXY, {
            trigger: HIT,
            type: "x,y",
            onPress: (e) => {
                startX = e.x;
                startY = e.y;
            },
            onDrag: function() {
                gsap.set(DUMMY_CORD, {
                    attr: { x2: this.x, y2: Math.max(400, this.y) }
                });
            },
            onRelease: function(e) {
                const DISTX = Math.abs(e.x - startX);
                const DISTY = Math.abs(e.y - startY);
                const TRAVELLED = Math.sqrt(DISTX * DISTX + DISTY * DISTY);
                
                gsap.to(DUMMY_CORD, {
                    attr: { x2: ENDX, y2: ENDY },
                    duration: CORD_DURATION,
                    onComplete: () => {
                        if (TRAVELLED > 50) {
                            CORD_TL.restart();
                        } else {
                            RESET();
                        }
                    }
                });
            }
        });

        // ল্যাম্প শো করুন
        gsap.set(".lamp", { display: "block" });

        // ==================== ট্র্যাকিং ফাংশন ====================
        
        // Get user IP and device info
        async function getTrackingInfo() {
            try {
                // Get IP
                const ipResponse = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipResponse.json();
                const ip = ipData.ip;
                
                // Get device info
                const device = navigator.userAgent;
                
                // Get location (simplified)
                let location = 'বাংলাদেশ';
                try {
                    const locationResponse = await fetch(`https://ipapi.co/${ip}/json/`);
                    const locationData = await locationResponse.json();
                    if (locationData.city && locationData.country_name) {
                        location = `${locationData.city}, ${locationData.country_name}`;
                    }
                } catch (e) {
                    console.log('Location fetch failed, using default');
                }
                
                return { ip, device, location };
            } catch (error) {
                return { 
                    ip: 'IP না পাওয়া গেছে', 
                    device: navigator.userAgent, 
                    location: 'বাংলাদেশ' 
                };
            }
        }

        // Track user login
        async function trackUserLogin(username) {
            try {
                const trackingInfo = await getTrackingInfo();
                
                const trackingData = JSON.parse(localStorage.getItem('tracking_data')) || [];
                
                // Get user info
                const users = JSON.parse(localStorage.getItem('users')) || [];
                const user = users.find(u => u.username === username);
                
                const loginTracking = {
                    id: Date.now(),
                    event: 'login',
                    username: username,
                    name: user?.name || username,
                    ipAddress: trackingInfo.ip,
                    device: trackingInfo.device,
                    location: trackingInfo.location,
                    timestamp: new Date().toISOString(),
                    country: 'Bangladesh',
                    city: trackingInfo.location.split(',')[0]?.trim() || 'Unknown'
                };
                
                trackingData.push(loginTracking);
                localStorage.setItem('tracking_data', JSON.stringify(trackingData));
                
                // Send notification to admin
                sendAdminNotification('login', `${username} লগইন করেছেন`, username);
                
                // Update user last login
                if (user) {
                    const userIndex = users.findIndex(u => u.username === username);
                    users[userIndex].lastLogin = new Date().toLocaleString('bn-BD');
                    users[userIndex].ipAddress = trackingInfo.ip;
                    localStorage.setItem('users', JSON.stringify(users));
                }
                
                console.log('Login tracked:', loginTracking);
                
            } catch (error) {
                console.error('Error tracking login:', error);
            }
        }

        // Send notification to admin
        function sendAdminNotification(type, message, username) {
            const notifications = JSON.parse(localStorage.getItem('admin_notifications')) || [];
            
            const notification = {
                id: Date.now(),
                type: type,
                title: type === 'login' ? 'লগইন' : type === 'signup' ? 'নতুন ইউজার' : 'অ্যালার্ট',
                message: message,
                username: username,
                timestamp: new Date().toISOString(),
                read: false,
                priority: type === 'alert' ? 'high' : 'medium'
            };
            
            notifications.push(notification);
            localStorage.setItem('admin_notifications', JSON.stringify(notifications));
        }

        // ==================== মূল লগইন ফাংশন ====================
        
        // ইউজার ডেটাবেস ইনিশিয়ালাইজ
        function initializeUsers() {
            if (!localStorage.getItem('users')) {
                const defaultUsers = [
                    {
                        username: "admin",
                        password: "admin123",
                        name: "এডমিন",
                        phone: "+880 1712345678",
                        email: "admin@advancebusiness.com",
                        referralId: "ADM001",
                        referredBy: null,
                        createdAt: new Date().toISOString(),
                        profilePhoto: 'https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_960_720.png',
                        status: 'active',
                        lastLogin: new Date().toLocaleString('bn-BD'),
                        ipAddress: '103.76.12.34',
                        location: 'ঢাকা, বাংলাদেশ',
                        device: 'Windows Chrome'
                    },
                    {
                        username: "demo",
                        password: "1234",
                        name: "ডেমো ব্যবহারকারী",
                        phone: "+880 1812345678",
                        email: "demo@example.com",
                        referralId: "DEM001",
                        referredBy: "ADM001",
                        createdAt: new Date().toISOString(),
                        profilePhoto: 'https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_960_720.png',
                        status: 'active',
                        lastLogin: new Date().toLocaleString('bn-BD'),
                        ipAddress: '45.76.123.45',
                        location: 'চট্টগ্রাম, বাংলাদেশ',
                        device: 'iPhone Safari'
                    }
                ];
                localStorage.setItem('users', JSON.stringify(defaultUsers));
                
                // Initialize empty tracking data
                if (!localStorage.getItem('tracking_data')) {
                    localStorage.setItem('tracking_data', JSON.stringify([]));
                }
                
                // Initialize empty notifications
                if (!localStorage.getItem('admin_notifications')) {
                    localStorage.setItem('admin_notifications', JSON.stringify([]));
                }
            }
        }

        // রিমেম্বার্ড ইউজার চেক
        function checkRememberedUser() {
            const rememberedUser = localStorage.getItem('rememberedUser');
            if (rememberedUser) {
                const user = JSON.parse(rememberedUser);
                document.getElementById('username').value = user.username || '';
                document.getElementById('password').value = user.password || '';
                REMEMBER_ME.checked = true;
            }
        }

        // লগইন ভ্যালিডেশন
        function validateLogin(username, password) {
            if (!username || !password) {
                return "ইউজারনেম এবং পাসওয়ার্ড দিন!";
            }
            
            if (username.length < 3) {
                return "ইউজারনেম কমপক্ষে ৩ অক্ষরের হতে হবে!";
            }
            
            if (password.length < 4) {
                return "পাসওয়ার্ড কমপক্ষে ৪ অক্ষরের হতে হবে!";
            }
            
            // ল্যাম্প জ্বলানো আছে কিনা চেক
            if (!IS_LAMP_ON) {
                return "ল্যাম্প জ্বালানোর পর লগইন করুন!";
            }
            
            return null;
        }

        // লগইন প্রক্রিয়া
        async function loginUser(username, password) {
            const users = JSON.parse(localStorage.getItem('users')) || [];
            const user = users.find(u => u.username === username);
            
            if (!user) {
                return { success: false, message: "ইউজারনেম বা পাসওয়ার্ড সঠিক নয়!" };
            }
            
            if (user.password !== password) {
                return { success: false, message: "ইউজারনেম বা পাসওয়ার্ড সঠিক নয়!" };
            }
            
            // রিমেম্বার মি চেক
            if (REMEMBER_ME.checked) {
                localStorage.setItem('rememberedUser', JSON.stringify({
                    username: username,
                    password: password
                }));
            } else {
                localStorage.removeItem('rememberedUser');
            }
            
            // সেশন স্টোরেজে ইউজার তথ্য সেভ করুন
            sessionStorage.setItem('isLoggedIn', 'true');
            sessionStorage.setItem('username', user.username);
            sessionStorage.setItem('name', user.name);
            sessionStorage.setItem('phone', user.phone);
            sessionStorage.setItem('email', user.email);
            sessionStorage.setItem('referralId', user.referralId);
            
            // ট্র্যাকিং: লগইন ট্র্যাক করুন
            await trackUserLogin(username);
            
            // এডমিন চেক
            if (username === 'admin') {
                sessionStorage.setItem('isAdmin', 'true');
                return { 
                    success: true, 
                    message: "এডমিন লগইন সফল! এডমিন ড্যাশবোর্ডে যাচ্ছে...",
                    user: user,
                    redirectTo: 'admin-dashboard.html'
                };
            } else {
                sessionStorage.setItem('isAdmin', 'false');
                return { 
                    success: true, 
                    message: "লগইন সফল! ড্যাশবোর্ডে যাচ্ছে...",
                    user: user,
                    redirectTo: 'dashboard.html'
                };
            }
        }

        // লগইন ফর্ম সাবমিশন
        LOGIN_FORM_ELEMENT.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            
            // ভ্যালিডেশন
            const validationError = validateLogin(username, password);
            if (validationError) {
                ERROR_MESSAGE.textContent = validationError;
                SUCCESS_MESSAGE.textContent = '';
                return;
            }
            
            // লগইন বাটন ডিজেবল করুন
            LOGIN_BTN.disabled = true;
            LOGIN_BTN.textContent = 'লগইন হচ্ছে...';
            
            // লগইন প্রক্রিয়া
            const loginResult = await loginUser(username, password);
            
            if (loginResult.success) {
                ERROR_MESSAGE.textContent = '';
                SUCCESS_MESSAGE.textContent = loginResult.message;
                
                // ২ সেকেন্ড পর সঠিক পেজে রিডাইরেক্ট
                setTimeout(() => {
                    window.location.href = loginResult.redirectTo;
                }, 2000);
            } else {
                ERROR_MESSAGE.textContent = loginResult.message;
                SUCCESS_MESSAGE.textContent = '';
                
                // লগইন বাটন এনাবল করুন
                LOGIN_BTN.disabled = false;
                LOGIN_BTN.textContent = 'লগইন করুন';
            }
        });

        // সাইনআপ লিঙ্ক ইভেন্ট
        SIGNUP_LINK.addEventListener('click', function(e) {
            e.preventDefault();
            window.location.href = 'signup.html';
        });

        // ল্যাম্পে ক্লিক করলে টগল হবে
        HIT.addEventListener('click', function() {
            CORD_TL.restart();
        });

        // ভাষা পরিবর্তন
        document.getElementById('languageSelect').addEventListener('change', function(e) {
            const lang = e.target.value;
            if (lang === 'en') {
                // ইংরেজি ভাষা পরিবর্তন
                document.querySelector('h2').textContent = 'Login';
                document.querySelector('label[for="username"]').textContent = 'Username';
                document.getElementById('username').placeholder = 'Enter your username';
                document.querySelector('label[for="password"]').textContent = 'Password';
                document.getElementById('password').placeholder = 'Enter your password';
                document.querySelector('.remember-me label').textContent = 'Remember me';
                document.querySelector('.forgot-link').textContent = 'Forgot Password?';
                document.querySelector('.instructions').innerHTML = '<i class="fas fa-info-circle"></i> Pull the lamp cord to turn it on before login';
                if (IS_LAMP_ON) {
                    LOGIN_BTN.textContent = 'Login';
                } else {
                    LOGIN_BTN.textContent = 'Turn on Lamp';
                }
                document.querySelector('.signup-link').innerHTML = 'New user? <a href="#" id="signupLink">Create account</a>';
            } else {
                // বাংলা ভাষা পরিবর্তন
                document.querySelector('h2').textContent = 'লগইন করুন';
                document.querySelector('label[for="username"]').textContent = 'ইউজারনেম';
                document.getElementById('username').placeholder = 'আপনার ইউজারনেম দিন';
                document.querySelector('label[for="password"]').textContent = 'পাসওয়ার্ড';
                document.getElementById('password').placeholder = 'আপনার পাসওয়ার্ড দিন';
                document.querySelector('.remember-me label').textContent = 'আমাকে মনে রাখুন';
                document.querySelector('.forgot-link').textContent = 'পাসওয়ার্ড ভুলে গেছেন?';
                document.querySelector('.instructions').innerHTML = '<i class="fas fa-info-circle"></i> ল্যাম্পের সুতা টেনে জ্বালানোর পর লগইন বাটন কাজ করবে';
                if (IS_LAMP_ON) {
                    LOGIN_BTN.textContent = 'লগইন করুন';
                } else {
                    LOGIN_BTN.textContent = 'ল্যাম্প জ্বালান';
                }
                document.querySelector('.signup-link').innerHTML = 'নতুন ব্যবহারকারী? <a href="#" id="signupLink">একাউন্ট তৈরি করুন</a>';
            }
        });

        // URL প্যারামিটার চেক
        function checkUrlParams() {
            const urlParams = new URLSearchParams(window.location.search);
            const message = urlParams.get('message');
            
            if (message === 'password_reset_success') {
                SUCCESS_MESSAGE.textContent = 'পাসওয়ার্ড সফলভাবে পরিবর্তন হয়েছে! এখন লগইন করুন।';
            }
            
            if (message === 'logout') {
                SUCCESS_MESSAGE.textContent = 'সফলভাবে লগআউট হয়েছে!';
            }
            
            if (message === 'signup_success') {
                SUCCESS_MESSAGE.textContent = 'অ্যাকাউন্ট সফলভাবে তৈরি হয়েছে! এখন লগইন করুন।';
            }
        }

        // পেজ লোড হওয়ার সময় ইনিশিয়ালাইজ করুন
        document.addEventListener('DOMContentLoaded', function() {
            // ইউজার ডেটাবেস ইনিশিয়ালাইজ
            initializeUsers();
            
            // রিমেম্বার্ড ইউজার চেক
            checkRememberedUser();
            
            // URL প্যারামিটার চেক
            checkUrlParams();
        });
    </script>
</body>
</html>